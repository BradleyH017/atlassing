Global seed set to 0
/software/team152/bh18/conda_envs/sc4/lib/python3.9/site-packages/flax/struct.py:132: FutureWarning: jax.tree_util.register_keypaths is deprecated, and will be removed in a future release. Please use `register_pytree_with_keys()` instead.
  jax.tree_util.register_keypaths(data_clz, keypaths)
/software/team152/bh18/conda_envs/sc4/lib/python3.9/site-packages/flax/struct.py:132: FutureWarning: jax.tree_util.register_keypaths is deprecated, and will be removed in a future release. Please use `register_pytree_with_keys()` instead.
  jax.tree_util.register_keypaths(data_clz, keypaths)
/software/team152/bh18/conda_envs/sc4/lib/python3.9/site-packages/umap/distances.py:1063: NumbaDeprecationWarning: [1mThe 'nopython' keyword argument was not supplied to the 'numba.jit' decorator. The implicit default value for this argument is currently False, but it will be changed to True in Numba 0.59.0. See https://numba.readthedocs.io/en/stable/reference/deprecation.html#deprecation-of-object-mode-fall-back-behaviour-when-using-jit for details.[0m
  @numba.jit()
/software/team152/bh18/conda_envs/sc4/lib/python3.9/site-packages/umap/distances.py:1071: NumbaDeprecationWarning: [1mThe 'nopython' keyword argument was not supplied to the 'numba.jit' decorator. The implicit default value for this argument is currently False, but it will be changed to True in Numba 0.59.0. See https://numba.readthedocs.io/en/stable/reference/deprecation.html#deprecation-of-object-mode-fall-back-behaviour-when-using-jit for details.[0m
  @numba.jit()
/software/team152/bh18/conda_envs/sc4/lib/python3.9/site-packages/umap/distances.py:1086: NumbaDeprecationWarning: [1mThe 'nopython' keyword argument was not supplied to the 'numba.jit' decorator. The implicit default value for this argument is currently False, but it will be changed to True in Numba 0.59.0. See https://numba.readthedocs.io/en/stable/reference/deprecation.html#deprecation-of-object-mode-fall-back-behaviour-when-using-jit for details.[0m
  @numba.jit()
/software/team152/bh18/conda_envs/sc4/lib/python3.9/site-packages/umap/umap_.py:660: NumbaDeprecationWarning: [1mThe 'nopython' keyword argument was not supplied to the 'numba.jit' decorator. The implicit default value for this argument is currently False, but it will be changed to True in Numba 0.59.0. See https://numba.readthedocs.io/en/stable/reference/deprecation.html#deprecation-of-object-mode-fall-back-behaviour-when-using-jit for details.[0m
  @numba.jit()
/software/team152/bh18/conda_envs/sc4/lib/python3.9/site-packages/anndata/_core/anndata.py:788: UserWarning: 
AnnData expects .obs.index to contain strings, but got values like:
    [0, 1, 2, 3, 4]

    Inferred to be: integer

  value_idx = self._prep_dim_index(value.index, attr)
/software/team152/bh18/conda_envs/sc4/lib/python3.9/site-packages/anndata/_core/anndata.py:1230: ImplicitModificationWarning: Trying to modify attribute `.obs` of view, initializing view as actual.
  df[key] = c
/software/team152/bh18/conda_envs/sc4/lib/python3.9/site-packages/anndata/_core/anndata.py:1230: ImplicitModificationWarning: Trying to modify attribute `.obs` of view, initializing view as actual.
  df[key] = c
/software/team152/bh18/conda_envs/sc4/lib/python3.9/site-packages/anndata/_core/anndata.py:1230: ImplicitModificationWarning: Trying to modify attribute `.obs` of view, initializing view as actual.
  df[key] = c
/software/team152/bh18/conda_envs/sc4/lib/python3.9/site-packages/anndata/_core/anndata.py:1230: ImplicitModificationWarning: Trying to modify attribute `.obs` of view, initializing view as actual.
  df[key] = c
/software/team152/bh18/conda_envs/sc4/lib/python3.9/site-packages/anndata/_core/anndata.py:1230: ImplicitModificationWarning: Trying to modify attribute `.obs` of view, initializing view as actual.
  df[key] = c
/software/team152/bh18/conda_envs/sc4/lib/python3.9/site-packages/anndata/_core/anndata.py:1230: ImplicitModificationWarning: Trying to modify attribute `.obs` of view, initializing view as actual.
  df[key] = c
/software/team152/bh18/conda_envs/sc4/lib/python3.9/site-packages/anndata/_core/anndata.py:1230: ImplicitModificationWarning: Trying to modify attribute `.obs` of view, initializing view as actual.
  df[key] = c
/software/team152/bh18/conda_envs/sc4/lib/python3.9/site-packages/anndata/_core/anndata.py:1230: ImplicitModificationWarning: Trying to modify attribute `.obs` of view, initializing view as actual.
  df[key] = c
/software/team152/bh18/conda_envs/sc4/lib/python3.9/site-packages/anndata/_core/anndata.py:1230: ImplicitModificationWarning: Trying to modify attribute `.obs` of view, initializing view as actual.
  df[key] = c
/software/team152/bh18/conda_envs/sc4/lib/python3.9/site-packages/anndata/_core/anndata.py:1230: ImplicitModificationWarning: Trying to modify attribute `.obs` of view, initializing view as actual.
  df[key] = c
/software/team152/bh18/conda_envs/sc4/lib/python3.9/site-packages/anndata/_core/anndata.py:1230: ImplicitModificationWarning: Trying to modify attribute `.obs` of view, initializing view as actual.
  df[key] = c
/software/team152/bh18/conda_envs/sc4/lib/python3.9/site-packages/anndata/_core/anndata.py:1230: ImplicitModificationWarning: Trying to modify attribute `.obs` of view, initializing view as actual.
  df[key] = c
/software/team152/bh18/conda_envs/sc4/lib/python3.9/site-packages/seaborn/axisgrid.py:118: UserWarning: The figure layout has changed to tight
  self._figure.tight_layout(*args, **kwargs)
WARNING: saving figure to file rectum/healthy/All_not_gt_subset/figures/violin.png
/software/team152/bh18/conda_envs/sc4/lib/python3.9/site-packages/scanpy/plotting/_utils.py:314: UserWarning: Matplotlib is currently using agg, which is a non-GUI backend, so cannot show the figure.
  pl.show()
/lustre/scratch126/humgen/projects/sc-eqtl-ibd/analysis/bradley_analysis/scripts/scRNAseq/Atlassing/atlassing_rectum_all_samples.py:130: UserWarning: 

`distplot` is a deprecated function and will be removed in seaborn v0.14.0.

Please adapt your code to use either `displot` (a figure-level function with
similar flexibility) or `kdeplot` (an axes-level function for kernel density plots).

For a guide to updating your code to use the new functions, please see
https://gist.github.com/mwaskom/de44147ed2974457ad6372750bbe5751

  sns.distplot(data, hist=False, rug=True, label=c)
/lustre/scratch126/humgen/projects/sc-eqtl-ibd/analysis/bradley_analysis/scripts/scRNAseq/Atlassing/atlassing_rectum_all_samples.py:130: UserWarning: 

`distplot` is a deprecated function and will be removed in seaborn v0.14.0.

Please adapt your code to use either `displot` (a figure-level function with
similar flexibility) or `kdeplot` (an axes-level function for kernel density plots).

For a guide to updating your code to use the new functions, please see
https://gist.github.com/mwaskom/de44147ed2974457ad6372750bbe5751

  sns.distplot(data, hist=False, rug=True, label=c)
/lustre/scratch126/humgen/projects/sc-eqtl-ibd/analysis/bradley_analysis/scripts/scRNAseq/Atlassing/atlassing_rectum_all_samples.py:130: UserWarning: 

`distplot` is a deprecated function and will be removed in seaborn v0.14.0.

Please adapt your code to use either `displot` (a figure-level function with
similar flexibility) or `kdeplot` (an axes-level function for kernel density plots).

For a guide to updating your code to use the new functions, please see
https://gist.github.com/mwaskom/de44147ed2974457ad6372750bbe5751

  sns.distplot(data, hist=False, rug=True, label=c)
/lustre/scratch126/humgen/projects/sc-eqtl-ibd/analysis/bradley_analysis/scripts/scRNAseq/Atlassing/atlassing_rectum_all_samples.py:130: UserWarning: 

`distplot` is a deprecated function and will be removed in seaborn v0.14.0.

Please adapt your code to use either `displot` (a figure-level function with
similar flexibility) or `kdeplot` (an axes-level function for kernel density plots).

For a guide to updating your code to use the new functions, please see
https://gist.github.com/mwaskom/de44147ed2974457ad6372750bbe5751

  sns.distplot(data, hist=False, rug=True, label=c)
/lustre/scratch126/humgen/projects/sc-eqtl-ibd/analysis/bradley_analysis/scripts/scRNAseq/Atlassing/atlassing_rectum_all_samples.py:130: UserWarning: 

`distplot` is a deprecated function and will be removed in seaborn v0.14.0.

Please adapt your code to use either `displot` (a figure-level function with
similar flexibility) or `kdeplot` (an axes-level function for kernel density plots).

For a guide to updating your code to use the new functions, please see
https://gist.github.com/mwaskom/de44147ed2974457ad6372750bbe5751

  sns.distplot(data, hist=False, rug=True, label=c)
/lustre/scratch126/humgen/projects/sc-eqtl-ibd/analysis/bradley_analysis/scripts/scRNAseq/Atlassing/atlassing_rectum_all_samples.py:130: UserWarning: 

`distplot` is a deprecated function and will be removed in seaborn v0.14.0.

Please adapt your code to use either `displot` (a figure-level function with
similar flexibility) or `kdeplot` (an axes-level function for kernel density plots).

For a guide to updating your code to use the new functions, please see
https://gist.github.com/mwaskom/de44147ed2974457ad6372750bbe5751

  sns.distplot(data, hist=False, rug=True, label=c)
/lustre/scratch126/humgen/projects/sc-eqtl-ibd/analysis/bradley_analysis/scripts/scRNAseq/Atlassing/atlassing_rectum_all_samples.py:130: UserWarning: 

`distplot` is a deprecated function and will be removed in seaborn v0.14.0.

Please adapt your code to use either `displot` (a figure-level function with
similar flexibility) or `kdeplot` (an axes-level function for kernel density plots).

For a guide to updating your code to use the new functions, please see
https://gist.github.com/mwaskom/de44147ed2974457ad6372750bbe5751

  sns.distplot(data, hist=False, rug=True, label=c)
/lustre/scratch126/humgen/projects/sc-eqtl-ibd/analysis/bradley_analysis/scripts/scRNAseq/Atlassing/atlassing_rectum_all_samples.py:130: UserWarning: 

`distplot` is a deprecated function and will be removed in seaborn v0.14.0.

Please adapt your code to use either `displot` (a figure-level function with
similar flexibility) or `kdeplot` (an axes-level function for kernel density plots).

For a guide to updating your code to use the new functions, please see
https://gist.github.com/mwaskom/de44147ed2974457ad6372750bbe5751

  sns.distplot(data, hist=False, rug=True, label=c)
/lustre/scratch126/humgen/projects/sc-eqtl-ibd/analysis/bradley_analysis/scripts/scRNAseq/Atlassing/atlassing_rectum_all_samples.py:152: UserWarning: 

`distplot` is a deprecated function and will be removed in seaborn v0.14.0.

Please adapt your code to use either `displot` (a figure-level function with
similar flexibility) or `histplot` (an axes-level function for histograms).

For a guide to updating your code to use the new functions, please see
https://gist.github.com/mwaskom/de44147ed2974457ad6372750bbe5751

  sns.distplot(np.log10(ncounts_gt1))
/lustre/scratch126/humgen/projects/sc-eqtl-ibd/analysis/bradley_analysis/scripts/scRNAseq/Atlassing/atlassing_rectum_all_samples.py:164: UserWarning: 

`distplot` is a deprecated function and will be removed in seaborn v0.14.0.

Please adapt your code to use either `displot` (a figure-level function with
similar flexibility) or `kdeplot` (an axes-level function for kernel density plots).

For a guide to updating your code to use the new functions, please see
https://gist.github.com/mwaskom/de44147ed2974457ad6372750bbe5751

  sns.distplot(data, hist=False, rug=True, label=c)
/lustre/scratch126/humgen/projects/sc-eqtl-ibd/analysis/bradley_analysis/scripts/scRNAseq/Atlassing/atlassing_rectum_all_samples.py:164: UserWarning: 

`distplot` is a deprecated function and will be removed in seaborn v0.14.0.

Please adapt your code to use either `displot` (a figure-level function with
similar flexibility) or `kdeplot` (an axes-level function for kernel density plots).

For a guide to updating your code to use the new functions, please see
https://gist.github.com/mwaskom/de44147ed2974457ad6372750bbe5751

  sns.distplot(data, hist=False, rug=True, label=c)
/lustre/scratch126/humgen/projects/sc-eqtl-ibd/analysis/bradley_analysis/scripts/scRNAseq/Atlassing/atlassing_rectum_all_samples.py:164: UserWarning: 

`distplot` is a deprecated function and will be removed in seaborn v0.14.0.

Please adapt your code to use either `displot` (a figure-level function with
similar flexibility) or `kdeplot` (an axes-level function for kernel density plots).

For a guide to updating your code to use the new functions, please see
https://gist.github.com/mwaskom/de44147ed2974457ad6372750bbe5751

  sns.distplot(data, hist=False, rug=True, label=c)
/lustre/scratch126/humgen/projects/sc-eqtl-ibd/analysis/bradley_analysis/scripts/scRNAseq/Atlassing/atlassing_rectum_all_samples.py:164: UserWarning: 

`distplot` is a deprecated function and will be removed in seaborn v0.14.0.

Please adapt your code to use either `displot` (a figure-level function with
similar flexibility) or `kdeplot` (an axes-level function for kernel density plots).

For a guide to updating your code to use the new functions, please see
https://gist.github.com/mwaskom/de44147ed2974457ad6372750bbe5751

  sns.distplot(data, hist=False, rug=True, label=c)
/lustre/scratch126/humgen/projects/sc-eqtl-ibd/analysis/bradley_analysis/scripts/scRNAseq/Atlassing/atlassing_rectum_all_samples.py:164: UserWarning: 

`distplot` is a deprecated function and will be removed in seaborn v0.14.0.

Please adapt your code to use either `displot` (a figure-level function with
similar flexibility) or `kdeplot` (an axes-level function for kernel density plots).

For a guide to updating your code to use the new functions, please see
https://gist.github.com/mwaskom/de44147ed2974457ad6372750bbe5751

  sns.distplot(data, hist=False, rug=True, label=c)
/lustre/scratch126/humgen/projects/sc-eqtl-ibd/analysis/bradley_analysis/scripts/scRNAseq/Atlassing/atlassing_rectum_all_samples.py:164: UserWarning: 

`distplot` is a deprecated function and will be removed in seaborn v0.14.0.

Please adapt your code to use either `displot` (a figure-level function with
similar flexibility) or `kdeplot` (an axes-level function for kernel density plots).

For a guide to updating your code to use the new functions, please see
https://gist.github.com/mwaskom/de44147ed2974457ad6372750bbe5751

  sns.distplot(data, hist=False, rug=True, label=c)
/lustre/scratch126/humgen/projects/sc-eqtl-ibd/analysis/bradley_analysis/scripts/scRNAseq/Atlassing/atlassing_rectum_all_samples.py:164: UserWarning: 

`distplot` is a deprecated function and will be removed in seaborn v0.14.0.

Please adapt your code to use either `displot` (a figure-level function with
similar flexibility) or `kdeplot` (an axes-level function for kernel density plots).

For a guide to updating your code to use the new functions, please see
https://gist.github.com/mwaskom/de44147ed2974457ad6372750bbe5751

  sns.distplot(data, hist=False, rug=True, label=c)
/lustre/scratch126/humgen/projects/sc-eqtl-ibd/analysis/bradley_analysis/scripts/scRNAseq/Atlassing/atlassing_rectum_all_samples.py:164: UserWarning: 

`distplot` is a deprecated function and will be removed in seaborn v0.14.0.

Please adapt your code to use either `displot` (a figure-level function with
similar flexibility) or `kdeplot` (an axes-level function for kernel density plots).

For a guide to updating your code to use the new functions, please see
https://gist.github.com/mwaskom/de44147ed2974457ad6372750bbe5751

  sns.distplot(data, hist=False, rug=True, label=c)
/lustre/scratch126/humgen/projects/sc-eqtl-ibd/analysis/bradley_analysis/scripts/scRNAseq/Atlassing/atlassing_rectum_all_samples.py:173: ImplicitModificationWarning: Trying to modify attribute `.obs` of view, initializing view as actual.
  adata.obs["express_gt100"] = express_gt100
/software/team152/bh18/conda_envs/sc4/lib/python3.9/site-packages/seaborn/axisgrid.py:118: UserWarning: The figure layout has changed to tight
  self._figure.tight_layout(*args, **kwargs)
WARNING: saving figure to file rectum/healthy/All_not_gt_subset/figures/violin_mt_perc.png
/software/team152/bh18/conda_envs/sc4/lib/python3.9/site-packages/scanpy/plotting/_utils.py:314: UserWarning: Matplotlib is currently using agg, which is a non-GUI backend, so cannot show the figure.
  pl.show()
/lustre/scratch126/humgen/projects/sc-eqtl-ibd/analysis/bradley_analysis/scripts/scRNAseq/Atlassing/atlassing_rectum_all_samples.py:232: UserWarning: 

`distplot` is a deprecated function and will be removed in seaborn v0.14.0.

Please adapt your code to use either `displot` (a figure-level function with
similar flexibility) or `kdeplot` (an axes-level function for kernel density plots).

For a guide to updating your code to use the new functions, please see
https://gist.github.com/mwaskom/de44147ed2974457ad6372750bbe5751

  sns.distplot(data, hist=False, rug=True, label=c)
/lustre/scratch126/humgen/projects/sc-eqtl-ibd/analysis/bradley_analysis/scripts/scRNAseq/Atlassing/atlassing_rectum_all_samples.py:232: UserWarning: 

`distplot` is a deprecated function and will be removed in seaborn v0.14.0.

Please adapt your code to use either `displot` (a figure-level function with
similar flexibility) or `kdeplot` (an axes-level function for kernel density plots).

For a guide to updating your code to use the new functions, please see
https://gist.github.com/mwaskom/de44147ed2974457ad6372750bbe5751

  sns.distplot(data, hist=False, rug=True, label=c)
/lustre/scratch126/humgen/projects/sc-eqtl-ibd/analysis/bradley_analysis/scripts/scRNAseq/Atlassing/atlassing_rectum_all_samples.py:232: UserWarning: 

`distplot` is a deprecated function and will be removed in seaborn v0.14.0.

Please adapt your code to use either `displot` (a figure-level function with
similar flexibility) or `kdeplot` (an axes-level function for kernel density plots).

For a guide to updating your code to use the new functions, please see
https://gist.github.com/mwaskom/de44147ed2974457ad6372750bbe5751

  sns.distplot(data, hist=False, rug=True, label=c)
/lustre/scratch126/humgen/projects/sc-eqtl-ibd/analysis/bradley_analysis/scripts/scRNAseq/Atlassing/atlassing_rectum_all_samples.py:232: UserWarning: 

`distplot` is a deprecated function and will be removed in seaborn v0.14.0.

Please adapt your code to use either `displot` (a figure-level function with
similar flexibility) or `kdeplot` (an axes-level function for kernel density plots).

For a guide to updating your code to use the new functions, please see
https://gist.github.com/mwaskom/de44147ed2974457ad6372750bbe5751

  sns.distplot(data, hist=False, rug=True, label=c)
/lustre/scratch126/humgen/projects/sc-eqtl-ibd/analysis/bradley_analysis/scripts/scRNAseq/Atlassing/atlassing_rectum_all_samples.py:232: UserWarning: 

`distplot` is a deprecated function and will be removed in seaborn v0.14.0.

Please adapt your code to use either `displot` (a figure-level function with
similar flexibility) or `kdeplot` (an axes-level function for kernel density plots).

For a guide to updating your code to use the new functions, please see
https://gist.github.com/mwaskom/de44147ed2974457ad6372750bbe5751

  sns.distplot(data, hist=False, rug=True, label=c)
/lustre/scratch126/humgen/projects/sc-eqtl-ibd/analysis/bradley_analysis/scripts/scRNAseq/Atlassing/atlassing_rectum_all_samples.py:232: UserWarning: 

`distplot` is a deprecated function and will be removed in seaborn v0.14.0.

Please adapt your code to use either `displot` (a figure-level function with
similar flexibility) or `kdeplot` (an axes-level function for kernel density plots).

For a guide to updating your code to use the new functions, please see
https://gist.github.com/mwaskom/de44147ed2974457ad6372750bbe5751

  sns.distplot(data, hist=False, rug=True, label=c)
/lustre/scratch126/humgen/projects/sc-eqtl-ibd/analysis/bradley_analysis/scripts/scRNAseq/Atlassing/atlassing_rectum_all_samples.py:232: UserWarning: 

`distplot` is a deprecated function and will be removed in seaborn v0.14.0.

Please adapt your code to use either `displot` (a figure-level function with
similar flexibility) or `kdeplot` (an axes-level function for kernel density plots).

For a guide to updating your code to use the new functions, please see
https://gist.github.com/mwaskom/de44147ed2974457ad6372750bbe5751

  sns.distplot(data, hist=False, rug=True, label=c)
/lustre/scratch126/humgen/projects/sc-eqtl-ibd/analysis/bradley_analysis/scripts/scRNAseq/Atlassing/atlassing_rectum_all_samples.py:232: UserWarning: 

`distplot` is a deprecated function and will be removed in seaborn v0.14.0.

Please adapt your code to use either `displot` (a figure-level function with
similar flexibility) or `kdeplot` (an axes-level function for kernel density plots).

For a guide to updating your code to use the new functions, please see
https://gist.github.com/mwaskom/de44147ed2974457ad6372750bbe5751

  sns.distplot(data, hist=False, rug=True, label=c)
/lustre/scratch126/humgen/projects/sc-eqtl-ibd/analysis/bradley_analysis/scripts/scRNAseq/Atlassing/atlassing_rectum_all_samples.py:250: ImplicitModificationWarning: Trying to modify attribute `.obs` of view, initializing view as actual.
  adata.obs["mt_perc_less_50"] = mt_perc_ls50
/lustre/scratch126/humgen/projects/sc-eqtl-ibd/analysis/bradley_analysis/scripts/scRNAseq/Atlassing/atlassing_rectum_all_samples.py:266: UserWarning: 

`distplot` is a deprecated function and will be removed in seaborn v0.14.0.

Please adapt your code to use either `displot` (a figure-level function with
similar flexibility) or `histplot` (an axes-level function for histograms).

For a guide to updating your code to use the new functions, please see
https://gist.github.com/mwaskom/de44147ed2974457ad6372750bbe5751

  sns.distplot(cells_sample.Ncells)
/lustre/scratch126/humgen/projects/sc-eqtl-ibd/analysis/bradley_analysis/scripts/scRNAseq/Atlassing/atlassing_rectum_all_samples.py:289: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  temp['convoluted_samplename'] = temp['convoluted_samplename'].astype("string")
/lustre/scratch126/humgen/projects/sc-eqtl-ibd/analysis/bradley_analysis/scripts/scRNAseq/Atlassing/atlassing_rectum_all_samples.py:290: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  temp['convoluted_samplename'] = temp['convoluted_samplename'].astype("category")
/lustre/scratch126/humgen/projects/sc-eqtl-ibd/analysis/bradley_analysis/scripts/scRNAseq/Atlassing/atlassing_rectum_all_samples.py:305: ImplicitModificationWarning: Trying to modify attribute `.obs` of view, initializing view as actual.
  adata.obs["ngenes_per_cell"] = ncounts_gt1
filtered out 5626 genes that are detected in less than 6 cells
normalizing counts per cell
    finished (0:00:13)
If you pass `n_top_genes`, all cutoffs are ignored.
extracting highly variable genes
    finished (0:03:17)
--> added
    'highly_variable', boolean vector (adata.var)
    'means', float vector (adata.var)
    'dispersions', float vector (adata.var)
    'dispersions_norm', float vector (adata.var)
... as `zero_center=True`, sparse input is densified and may lead to large memory consumption
computing PCA
    on highly variable genes
    with n_comps=50
    finished (0:01:13)
/software/team152/bh18/conda_envs/sc4/lib/python3.9/site-packages/scanpy/plotting/_tools/scatterplots.py:392: UserWarning: No data for colormapping provided via 'c'. Parameters 'cmap', 'norm' will be ignored
  cax = scatter(
WARNING: saving figure to file rectum/healthy/All_not_gt_subset/figures/pcaTrue.png
/software/team152/bh18/conda_envs/sc4/lib/python3.9/site-packages/scanpy/plotting/_utils.py:314: UserWarning: Matplotlib is currently using agg, which is a non-GUI backend, so cannot show the figure.
  pl.show()
WARNING: saving figure to file rectum/healthy/All_not_gt_subset/figures/pca_variance_ratio.png
No GPU/TPU found, falling back to CPU. (Set TF_CPP_MIN_LOG_LEVEL=0 and rerun for more info.)
GPU available: False, used: False
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
`Trainer.fit` stopped: `max_epochs=21` reached.
Computing neighbors:   0%|          | 0/2 [00:00<?, ?it/s]Computing neighbors:  50%|█████     | 1/2 [11:17<11:17, 677.33s/it]Computing neighbors: 100%|██████████| 2/2 [25:03<00:00, 764.68s/it]Computing neighbors: 100%|██████████| 2/2 [25:03<00:00, 751.58s/it]
Embeddings:   0%|[32m          [0m| 0/2 [00:00<?, ?it/s]
Metrics:   0%|[34m          [0m| 0/10 [00:00<?, ?it/s][A
Metrics:   0%|[34m          [0m| 0/10 [00:00<?, ?it/s, Bio conservation: isolated_labels][A
Metrics:  10%|[34m█         [0m| 1/10 [4:42:01<42:18:13, 16921.48s/it, Bio conservation: isolated_labels][A
Metrics:  10%|[34m█         [0m| 1/10 [4:42:01<42:18:13, 16921.48s/it, Bio conservation: nmi_ari_cluster_labels_kmeans][A
Metrics:  20%|[34m██        [0m| 2/10 [4:44:59<15:42:59, 7072.44s/it, Bio conservation: nmi_ari_cluster_labels_kmeans] [A
Metrics:  20%|[34m██        [0m| 2/10 [4:44:59<15:42:59, 7072.44s/it, Bio conservation: silhouette_label]             [A
Metrics:  30%|[34m███       [0m| 3/10 [9:14:35<21:50:06, 11229.43s/it, Bio conservation: silhouette_label][A
Metrics:  30%|[34m███       [0m| 3/10 [9:14:35<21:50:06, 11229.43s/it, Bio conservation: clisi_knn]       [A
Metrics:  40%|[34m████      [0m| 4/10 [9:14:49<11:20:09, 6801.52s/it, Bio conservation: clisi_knn] [A
Metrics:  40%|[34m████      [0m| 4/10 [9:14:49<11:20:09, 6801.52s/it, Batch correction: silhouette_batch][A
Metrics:  50%|[34m█████     [0m| 5/10 [9:35:27<6:39:36, 4795.27s/it, Batch correction: silhouette_batch] [A
Metrics:  50%|[34m█████     [0m| 5/10 [9:35:27<6:39:36, 4795.27s/it, Batch correction: ilisi_knn]       [A
Metrics:  60%|[34m██████    [0m| 6/10 [9:35:40<3:31:17, 3169.26s/it, Batch correction: ilisi_knn][A
Metrics:  60%|[34m██████    [0m| 6/10 [9:35:40<3:31:17, 3169.26s/it, Batch correction: kbet_per_label][A
Metrics:  70%|[34m███████   [0m| 7/10 [9:40:31<1:51:24, 2228.30s/it, Batch correction: kbet_per_label][A
Metrics:  70%|[34m███████   [0m| 7/10 [9:40:31<1:51:24, 2228.30s/it, Batch correction: graph_connectivity][A
Metrics:  80%|[34m████████  [0m| 8/10 [9:40:33<50:39, 1519.61s/it, Batch correction: graph_connectivity]  [A
Metrics:  80%|[34m████████  [0m| 8/10 [9:40:33<50:39, 1519.61s/it, Batch correction: pcr_comparison]    [A
Metrics:  90%|[34m█████████ [0m| 9/10 [9:40:55<17:31, 1051.34s/it, Batch correction: pcr_comparison][AEmbeddings:  50%|[32m█████     [0m| 1/2 [9:40:55<9:40:55, 34855.16s/it]
Metrics:   0%|[34m          [0m| 0/10 [00:00<?, ?it/s][A
                                                                                             [A
Metrics:   0%|[34m          [0m| 0/10 [00:00<?, ?it/s, Bio conservation: isolated_labels][A
Metrics:  10%|[34m█         [0m| 1/10 [27:05<4:03:47, 1625.25s/it, Bio conservation: isolated_labels][A
Metrics:  10%|[34m█         [0m| 1/10 [27:05<4:03:47, 1625.25s/it, Bio conservation: nmi_ari_cluster_labels_kmeans][A
Metrics:  20%|[34m██        [0m| 2/10 [29:23<1:40:04, 750.56s/it, Bio conservation: nmi_ari_cluster_labels_kmeans] [A
Metrics:  20%|[34m██        [0m| 2/10 [29:23<1:40:04, 750.56s/it, Bio conservation: silhouette_label]             [A
Metrics:  30%|[34m███       [0m| 3/10 [56:24<2:13:56, 1148.02s/it, Bio conservation: silhouette_label][A
Metrics:  30%|[34m███       [0m| 3/10 [56:24<2:13:56, 1148.02s/it, Bio conservation: clisi_knn]       [A
Metrics:  40%|[34m████      [0m| 4/10 [56:31<1:09:46, 697.71s/it, Bio conservation: clisi_knn] [A
Metrics:  40%|[34m████      [0m| 4/10 [56:31<1:09:46, 697.71s/it, Batch correction: silhouette_batch][A
Metrics:  50%|[34m█████     [0m| 5/10 [57:49<39:30, 474.12s/it, Batch correction: silhouette_batch]  [A
Metrics:  50%|[34m█████     [0m| 5/10 [57:49<39:30, 474.12s/it, Batch correction: ilisi_knn]       [A
Metrics:  60%|[34m██████    [0m| 6/10 [57:57<21:02, 315.57s/it, Batch correction: ilisi_knn][A
Metrics:  60%|[34m██████    [0m| 6/10 [57:57<21:02, 315.57s/it, Batch correction: kbet_per_label][A
Metrics:  70%|[34m███████   [0m| 7/10 [1:02:21<14:55, 298.65s/it, Batch correction: kbet_per_label][A
Metrics:  70%|[34m███████   [0m| 7/10 [1:02:21<14:55, 298.65s/it, Batch correction: graph_connectivity][A
Metrics:  80%|[34m████████  [0m| 8/10 [1:02:22<06:47, 203.99s/it, Batch correction: graph_connectivity][A
Metrics:  80%|[34m████████  [0m| 8/10 [1:02:22<06:47, 203.99s/it, Batch correction: pcr_comparison]    [A/software/team152/bh18/conda_envs/sc4/lib/python3.9/site-packages/scib_metrics/_pcr_comparison.py:49: UserWarning: PCR comparison score is negative, meaning variance contribution increased after integration. Setting to 0.
  warnings.warn(

Metrics:  90%|[34m█████████ [0m| 9/10 [1:02:39<02:25, 145.41s/it, Batch correction: pcr_comparison][AEmbeddings: 100%|[32m██████████[0m| 2/2 [10:43:34<00:00, 16563.36s/it] Embeddings: 100%|[32m██████████[0m| 2/2 [10:43:34<00:00, 19307.13s/it]

                                                                                            [A/software/team152/bh18/conda_envs/sc4/lib/python3.9/site-packages/scanpy/plotting/_tools/scatterplots.py:392: UserWarning: No data for colormapping provided via 'c'. Parameters 'cmap' will be ignored
  cax = scatter(
the obs value 'convoluted_samplename' has more than 103 categories. Uniform 'grey' color will be used for all categories.
/software/team152/bh18/conda_envs/sc4/lib/python3.9/site-packages/scanpy/plotting/_tools/scatterplots.py:392: UserWarning: No data for colormapping provided via 'c'. Parameters 'cmap' will be ignored
  cax = scatter(
WARNING: saving figure to file rectum/healthy/All_not_gt_subset/figures/X_scVI_MDE.png
/software/team152/bh18/conda_envs/sc4/lib/python3.9/site-packages/scanpy/plotting/_utils.py:314: UserWarning: Matplotlib is currently using agg, which is a non-GUI backend, so cannot show the figure.
  pl.show()
computing neighbors
    finished: added to `.uns['pca_nn']`
    `.obsp['pca_nn_distances']`, distances for each pair of neighbors
    `.obsp['pca_nn_connectivities']`, weighted adjacency matrix (0:33:54)
computing UMAP
    finished: added
    'X_umap', UMAP coordinates (adata.obsm) (0:24:54)
/software/team152/bh18/conda_envs/sc4/lib/python3.9/site-packages/scanpy/plotting/_tools/scatterplots.py:392: UserWarning: No data for colormapping provided via 'c'. Parameters 'cmap' will be ignored
  cax = scatter(
WARNING: saving figure to file rectum/healthy/All_not_gt_subset/figures/umap_NN.png
/software/team152/bh18/conda_envs/sc4/lib/python3.9/site-packages/scanpy/plotting/_utils.py:314: UserWarning: Matplotlib is currently using agg, which is a non-GUI backend, so cannot show the figure.
  pl.show()
Traceback (most recent call last):
  File "/lustre/scratch126/humgen/projects/sc-eqtl-ibd/analysis/bradley_analysis/scripts/scRNAseq/Atlassing/atlassing_rectum_all_samples.py", line 566, in <module>
    adata.obs['convoluted_samplename'] = adata.obs.id_run.astype('category')
  File "/software/team152/bh18/conda_envs/sc4/lib/python3.9/site-packages/pandas/core/generic.py", line 5902, in __getattr__
    return object.__getattribute__(self, name)
AttributeError: 'DataFrame' object has no attribute 'id_run'
